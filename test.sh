##################################################
## ç”»é¢ã®åˆæœŸè¡¨ç¤ºæƒ…å ±
##   lnSeed[]ã«åˆæœŸè¡¨ç¤ºæƒ…å ±ã‚’æ ¼ç´ã™ã‚‹
##################################################
function initDispInfo(){

	declare -a -g lnSeed=() ##0ã‹ã‚‰25ã¾ã§ã®26è¦ç´ ç”¨æ„ã™ã‚‹ã¤ã‚‚ã‚Šã€‚

	#åˆæœŸçŠ¶æ…‹ 0000000001111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990
	#æ–‡å­—æ•°   1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
	lnSeed+=('+--+------------------------------------------------------------++------------+----------+---------+') #00
	lnSeed+=('|//|000000000111111111122222222223333333333444444444455555555556||Wriggle     |Bug       |Fighter  |') #01
	lnSeed+=('|//|123456789012345678901234567890123456789012345678901234567890|+--+---------+----------+---------+') #02
	lnSeed+=('+--+------------------------------------------------------------+|HP| 100/ 100|BLv: 1=     0/    10|') #03
	lnSeed+=('|01|000000000000000000000000000000000000000000000000000000000000||MP| 100/ 100|JLv: 1=     0/    10|') #04
	lnSeed+=('|02|000000000000000000000000000000000000000000000000000000000000|+--+--+--+--++-+--++--+--+--+--+--+') #05
	lnSeed+=('|03|000000000000000000000000000000000000000000000000000000000000||âœ|ğŸ’Š|ğŸ’¤|â”|ğŸ”‡|ğŸ‘“||ğŸ’ª|ğŸ›¡|ğŸ”¯|ğŸƒ|ğŸ€|') #06
	lnSeed+=('|04|000000000000000000000000000000000000000000000000000000000000|+--+--+--+--+--+--++--+--+--+--+--+') #07
	lnSeed+=('|05|000000000000000000000000000000000000000000000000000000000000|| 0| 0| 0| 0| 0| 0|| 0| 0| 0| 0| 0|') #08
	lnSeed+=('|06|000000000000000000000000000000000000000000000000000000000000|+--+--+--+--+--+--++--+--+--+--+--+') #09
	lnSeed+=('|07|000000000000000000000000000000000000000000000000000000000000||  VAL - STS - PAR |ğŸ”¨|â›°|ğŸ’§|ğŸ”¥|ğŸŒª|') #10
	lnSeed+=('|08|000000000000000000000000000000000000000000000000000000000000||*  10 < Str > Atk |10|10|10|10|10|') #11
	lnSeed+=('|09|000000000000000000000000000000000000000000000000000000000000||   10 < Int > Mat |10|10|10|10|10|') #12
	lnSeed+=('|10|000000000000000000000000000000000000000000000000000000000000||   10 < Vit > Def |10|10|10|10|10|') #13
	lnSeed+=('|11|000000000000000000000000000000000000000000000000000000000000||   10 < Mnd > Mdf |10|10|10|10|10|') #14
	lnSeed+=('|12|000000000000000000000000000000000000000000000000000000000000||   10 < Snc > XBns| 1  %+==+=====+') #15
	lnSeed+=('|13|000000000000000000000000000000000000000000000000000000000000||   10 < Dex > Hit |10  %|Jw|    0|') #16
	lnSeed+=('|14|000000000000000000000000000000000000000000000000000000000000||   10 < Agi > Flee|10  %|Gd|    0|') #17
	lnSeed+=('|15|000000000000000000000000000000000000000000000000000000000000||   10 < Luk > Cri |10  %|Sv|   50|') #18
	lnSeed+=('+==+============================================================++==================+=====+==+=====+') #19
	lnSeed+=('|91|                                                                                               |') #20
	lnSeed+=('|92|                                                                                               |') #21
	lnSeed+=('|93|                                                                                               |') #22
	lnSeed+=('|94|                                                                                               |') #23
	lnSeed+=('|95|                                                                                               |') #24
	lnSeed+=('+--+-------------------------------------------------------------------------input "??" to help.---+') #25
}

##################################################
## ã‚³ãƒãƒ³ãƒ‰ãƒ˜ãƒ«ãƒ—
##   termcapã«ã‚ˆã£ã¦ä¸Šã«ã‹ã¶ã›ã‚‹
##################################################
function viewHelp(){

	inKey=""

	tput smcup

	clear
	echo "***Command List***  Press [c]key to exit."
	echo ""
	echo "mn [CMD]    : CommandManual"
	echo "mv [n]      : Move"
	echo "ki [n]      : Kick"
	echo "wp [m][n]   : Attack with [m]Wapon"
	echo "ct [m][n]   : Cast [m]Magic"
	echo "in [n]      : Inspect"
	echo "gt [n]      : Get"
	echo "tr [m][n]   : Throw [m]Item"
	echo "tk [n]      : Talk"
	echo "pr          : Pray"
	echo "cc          : Cancel"
	echo "ss          : Suiside!"

	while :
	do
		getChrH
		if [ "$inKey" = "c" ]; then
			tput rmcup
			break
		else
			echo "$inKey is invalid. press [c] to exit."
		fi
	done

}

##################################################
## MNã‚³ãƒãƒ³ãƒ‰
##   å¼•æ•°ã§å—ã‘å–ã£ãŸã‚³ãƒãƒ³ãƒ‰ã®Manualã‚’è¡¨ç¤ºã™ã‚‹
##################################################
function mnCmd(){
	echo "manCmd"
	read inKey
}

##################################################
## ç”»é¢ã®å…¨æƒ…å ±ã‚’æ›´æ–°è¡¨ç¤º
##   lnSeed[]ã§ç”»é¢ã‚’æ›´æ–°ã™ã‚‹
##################################################
function dispAll(){
	clear
	for ((i = 0; i < ${#lnSeed[*]}; i++)) {
		echo "${lnSeed[i]}"
	}
}

##################################################
##getCntSingleWidth
## ä¸ãˆã‚‰ã‚ŒãŸæ–‡å­—åˆ—ãŒã€åŠè§’æ–‡å­—ç›¸å½“ã§ä½•æ–‡å­—åˆ†ã«å½“ãŸã‚‹ã‹åˆ¤å®šã™ã‚‹ã€‚
## ãƒãƒ«ãƒãƒã‚¤ãƒˆæ–‡å­—ã‚’2ã€ãã‚Œä»¥å¤–ã‚’1ã¨ã—ãŸã„ãŒã‚ˆãã‚ã‹ã‚‰ãªã„ã®ã§ã€å¯èƒ½ãã†ãªè¨˜å·ã®ã¿
## $1:ã‚«ã‚¦ãƒ³ãƒˆå¯¾è±¡ã®æ–‡å­—
##################################################
function getCntSingleWidth(){

	local declare cntStr="$1"

	#åŠè§’è‹±æ•°è¨˜å·ä»¥å¤–ã®æ–‡å­—ä»¥å¤–ã‚’æ¶ˆã™=åŠè§’æ–‡å­—æ•°
	local declare cntS=$(echo -n "$cntStr" | sed -e 's@[^A-Za-z0-9~!@#$%&_=:;><,\*+.?{}()\ -\|]@@g' | wc -m)

	#åŠè§’è‹±æ•°è¨˜å·ã®æ–‡å­—ã‚’æ¶ˆã™=å…¨è§’æ–‡å­—æ•°
	local declare cntW=$(echo -n "$cntStr" | sed -e 's@[A-Za-z0-9~!@#$%&_=:;><,\*+.?{}()\ -\|]@@g' | wc -m)

	#å…¨è§’æ–‡å­—æ•°ã‚’ç¤ºã™cntWã¯äºŒå€ã—ã¦ã€2ã¤ã‚’è¶³ã™
	echo -n "$(($((cntW * 2))+cntS))"

}

##################################################
## ä½¿ç”¨é »åº¦ãŒé«˜ã„éšœå®³æ–‡å­—ã‚’ç½®æ›ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã€‚
## ã€ã§ãã‚Œã°å¿…é ˆå‘¼ã³å‡ºã—ã«ã—ãŸã„ãŒã©ã†ã™ã‚‹ã‹ã€‘
## ãƒ»åŠè§’ã‚«ã‚¿ã‚«ãƒŠã¯å…¨è§’ã‚«ã‚¿ã‚«ãƒŠã«ã™ã‚‹ã€‚
## ãƒ»ã€Œâ€¦(ä¸‰ç‚¹ãƒªãƒ¼ãƒ€)ã€ã®è¡¨ç¤ºãŒè©°ã¾ã£ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€ã€Œ...ã€(ãƒ”ãƒªã‚ªãƒ‰3ã¤)ã«ã™ã‚‹
## ãƒ»ã€Œ[ã€ã€Œ]ã€ã¯bashã§ãƒ–ãƒ©ã‚±ãƒƒãƒˆã¨ã—ã¦åˆ¤æ–­ã•ã‚Œã‚‹ãŸã‚ãã‚Œãã‚Œã€Œï¼»ã€ã€Œï¼½ã€ã¸ç½®æ›ã™ã‚‹ã€‚
## ãƒ»å…¨è§’ã‚¹ãƒšãƒ¼ã‚¹ã¯åŠè§’ã‚¹ãƒšãƒ¼ã‚¹2ã¤ã¸ç½®æ›ã™ã‚‹ã€‚
## ãƒ»ã‚¿ãƒ–ã¯åŠè§’ã‚¹ãƒšãƒ¼ã‚¹2ã¤ã¸ç½®æ›ã™ã‚‹ã€‚
## ãƒ»ãƒã‚¤ãƒ•ãƒ³ã«ä¼¼ãŸã„ãã¤ã‹ã®åŠè§’æ–‡å­—ã‚’åŠè§’ãƒã‚¤ãƒ•ãƒ³ã«ç½®æ›ã™ã‚‹ã€‚
## è¿”å´ã¯æ¨™æº–å‡ºåŠ›
## $1:å…¥åŠ›æ–‡å­—
##################################################
function crrctStr(){
	local declare cnvstr="$1"

	cnvstr=$(echo "$cnvstr" | nkf)       #åŠè§’ã‚«ãƒŠ
	cnvstr=${cnvstr//'['/'ï¼»'}		#[
	cnvstr=${cnvstr//']'/'ï¼½'}		#]
	cnvstr=${cnvstr//'â€¦'/'...'}	   #ä¸‰ç‚¹ãƒªãƒ¼ãƒ€
	cnvstr=${cnvstr//'ã€€'/'  '}		#å…¨è§’sp
	cnvstr=${cnvstr//'	'/'  '}		#ã‚¿ãƒ–æ–‡å­—
	cnvstr=${cnvstr//'-'/'-'}		#ãƒã‚¤ãƒ•ãƒ³ã«ä¼¼ãŸæ–‡å­—
	cnvstr=${cnvstr//'â€‘'/'-'}		#ãƒã‚¤ãƒ•ãƒ³ã«ä¼¼ãŸæ–‡å­—
	cnvstr=${cnvstr//'â€“'/'-'}		#ãƒã‚¤ãƒ•ãƒ³ã«ä¼¼ãŸæ–‡å­—
	cnvstr=${cnvstr//'â€”'/'-'}		#ãƒã‚¤ãƒ•ãƒ³ã«ä¼¼ãŸæ–‡å­—
	cnvstr=${cnvstr//'â€”'/'-'}		#ãƒã‚¤ãƒ•ãƒ³ã«ä¼¼ãŸæ–‡å­—
	cnvstr=${cnvstr//'ï½°'/'-'}		#ãƒã‚¤ãƒ•ãƒ³ã«ä¼¼ãŸæ–‡å­—

	echo "$cnvstr"
}

##################################################
## ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è¡¨ç¤ºæƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹
##   è¡¨ç¤ºå†…å®¹ã‚’å¤‰ãˆã‚‹ã ã‘ã§è¡¨ç¤ºã®æ›´æ–°ã¯ã—ãªã„
##   ã‚«ã‚¦ãƒ³ãƒˆå‰ã«ã€crctStrã§ä¸æ­£æ–‡å­—ã‚’è¿‘ã„æ–‡å­—ã«ç½®æ›ã™ã‚‹
##   $1 ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ä½•è¡Œç›®ã‹
##   $2 ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦$1è¡Œç›®ã®ä½•æ–‡å­—ç›®ã‹ã‚‰ã‹
##   $3 è¡¨ç¤ºã™ã‚‹æ–‡å­—
##################################################
function modMsg(){

	declare -i  tgtRow=$1
	declare -i tgtClmn=$(($2+4))
	declare     tgtStr=$(crrctStr "$3")

	declare leftStr="${lnSeed[19+$tgtRow]:0:$tgtClmn}"

	declare -i spCnt=$((99-$(getCntSingleWidth "$leftStr$tgtStr")))
	#getCntSingleWidth()ã§åŠè§’ç›¸å½“ã®æ–‡å­—æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
	#100æ–‡å­—-|1æ–‡å­—=99ã€-æ–‡å­—æ•°ã§SPACEã®åå¾©æ•°

	lnSeed[19+$tgtRow]="$leftStr$tgtStr`printf %${spCnt}s`|"

}

###########################################
##getChrV
## ä»»æ„ã®æ–‡å­—æ•°å…¥åŠ›å—ä»˜(ã‚¨ã‚³ãƒ¼ãƒãƒƒã‚¯ã‚ã‚Š)ã€‚
## mainã§å®šç¾©ã—ã¦ã„ã‚‹ã‚°ãƒ­ãƒ¼ãƒãƒ«inKeyã‚’ã‚¯ãƒªã‚¢ã—ã¦ã‹ã‚‰ã€å…¥åŠ›å€¤ã§ä¸Šæ›¸ã
###########################################
function getChrV(){
	inKey=""
	read inKey
}

###########################################=
##getChrH
## ãªã‚“ã‹1æ–‡å­—ã®å…¥åŠ›å—ä»˜(ã‚¨ã‚³ãƒ¼ãƒãƒƒã‚¯ãªã—)ã€‚
## mainã§å®šç¾©ã—ã¦ã„ã‚‹ã‚°ãƒ­ãƒ¼ãƒãƒ«inKeyã‚’ã‚¯ãƒªã‚¢ã—ã¦ã‹ã‚‰ã€å…¥åŠ›å€¤ã§ä¸Šæ›¸ã
###########################################
function getChrH(){
	inKey=""
	read -s -n 1 inKey
}

###########################################
##Main
## ã©ã†ã«ã‹ã—ã¾ã™
###########################################

	declare -g inKey=""

	initDispInfo
	modMsg 1 0 "Input Commoand. >"
	dispAll	
	tput cup 20 22

	getChrV
	case "$inKey" in
		"ci" )	modMsg 2 0 "ãƒãƒ«ãƒ[ï¼¯ï¼¨ï¼Œãƒªã‚°ãƒ«ã€ï¼‘å›,ã— ã‚“ã§ã§ãªã€€ãŠã—	ã¦ã“ã„ï¾Šï¾ï½°ï½¶.wWwâ€¦ğŸ’€]"
				break;;
		"??" )	viewHelp
				break;;
		* ) 	modMsg 2 0 "[$inKey]is invalid." ;;
	esac
	dispAll

	tput sc
	tput cup 20 22
	echo -n $inKey
	tput rc
